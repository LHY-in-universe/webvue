# Training Monitor API Mock

è¿™æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿè®­ç»ƒç›‘æ§APIçš„æœåŠ¡ï¼Œæä¾›ä¸åŸå§‹APIç›¸åŒçš„æ¥å£æ ¼å¼ï¼Œä½†è¿”å›éšæœºç”Ÿæˆçš„æ•°æ®ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **å®Œå…¨å…¼å®¹**: è¾“å…¥è¾“å‡ºæ ¼å¼ä¸åŸå§‹APIå®Œå…¨ç›¸åŒ
- ğŸ² **éšæœºæ•°æ®**: æ‰€æœ‰è¾“å‡ºæ•°æ®éƒ½æ˜¯éšæœºç”Ÿæˆçš„
- ğŸ“Š **å®æ—¶æ¨¡æ‹Ÿ**: æ¨¡æ‹ŸçœŸå®çš„è®­ç»ƒç›‘æ§åœºæ™¯
- ğŸš€ **å¿«é€Ÿéƒ¨ç½²**: ä¸€é”®å¯åŠ¨ï¼Œæ— éœ€å¤æ‚é…ç½®

## APIæ¥å£

### 1. é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯
```
GET /monitor/ray/cluster/node
```
è¿”å›é›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„ä¿¡æ¯å’ŒçŠ¶æ€ã€‚

### 2. é›†ç¾¤çŠ¶æ€
```
GET /monitor/ray/cluster/status
```
è¿”å›é›†ç¾¤çš„æ•´ä½“çŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯ã€‚

### 3. è®­ç»ƒç›‘æ§
```
GET /monitor/training/{task_id}
```
è¿”å›æŒ‡å®šè®­ç»ƒä»»åŠ¡çš„ç›‘æ§ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›åº¦ã€æŸå¤±ã€å‡†ç¡®ç‡ç­‰ã€‚

### 4. èŠ‚ç‚¹æŒ‡æ ‡
```
GET /monitor/ray/cluster/node/{node_id}/metrics
```
è¿”å›ç‰¹å®šèŠ‚ç‚¹çš„è¯¦ç»†æ€§èƒ½æŒ‡æ ‡ã€‚

## å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
```bash
chmod +x start.sh
./start.sh
```

### æ–¹æ³•2: æ‰‹åŠ¨å¯åŠ¨
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨æœåŠ¡
python main.py
```

## è®¿é—®åœ°å€

- **APIæœåŠ¡**: http://localhost:6677
- **APIæ–‡æ¡£**: http://localhost:6677/docs
- **å¥åº·æ£€æŸ¥**: http://localhost:6677/health

## æ•°æ®æ¨¡å‹

### èŠ‚ç‚¹ä¿¡æ¯ (RayNode)
- `id`: èŠ‚ç‚¹å”¯ä¸€æ ‡è¯†
- `name`: èŠ‚ç‚¹åç§°
- `ip`: èŠ‚ç‚¹IPåœ°å€
- `state`: èŠ‚ç‚¹çŠ¶æ€ (ALIVE/DEAD/UNKNOWN)
- `resources`: èµ„æºä¿¡æ¯ (CPU/å†…å­˜/GPU)
- `training`: è®­ç»ƒä»»åŠ¡ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰

### è®­ç»ƒç›‘æ§ (TrainingMonitorResponse)
- `task_id`: ä»»åŠ¡ID
- `status`: ä»»åŠ¡çŠ¶æ€
- `progress`: è®­ç»ƒè¿›åº¦ (0-1)
- `current_epoch`: å½“å‰è½®æ¬¡
- `total_epochs`: æ€»è½®æ¬¡
- `loss`: æŸå¤±å€¼
- `accuracy`: å‡†ç¡®ç‡ï¼ˆå¯é€‰ï¼‰
- `estimated_time_remaining`: é¢„ä¼°å‰©ä½™æ—¶é—´
- `nodes_involved`: å‚ä¸èŠ‚ç‚¹åˆ—è¡¨

## æµ‹è¯•ç¤ºä¾‹

### è·å–é›†ç¾¤èŠ‚ç‚¹
```bash
curl http://localhost:6677/monitor/ray/cluster/node
```

### è·å–è®­ç»ƒç›‘æ§
```bash
curl http://localhost:6677/monitor/training/task_123
```

### è·å–èŠ‚ç‚¹æŒ‡æ ‡
```bash
curl http://localhost:6677/monitor/ray/cluster/node/node_1234/metrics
```

## é…ç½®è¯´æ˜

- **ç«¯å£**: 6677 (ä¸åŸå§‹APIä¿æŒä¸€è‡´)
- **ä¸»æœº**: 0.0.0.0 (å…è®¸å¤–éƒ¨è®¿é—®)
- **æ•°æ®**: å®Œå…¨éšæœºç”Ÿæˆï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¸åŒ

## æ³¨æ„äº‹é¡¹

1. è¿™æ˜¯ä¸€ä¸ªæ¨¡æ‹ŸæœåŠ¡ï¼Œæ‰€æœ‰æ•°æ®éƒ½æ˜¯éšæœºç”Ÿæˆçš„
2. æ¯æ¬¡é‡å¯æœåŠ¡ï¼Œç”Ÿæˆçš„èŠ‚ç‚¹IDå’Œä»»åŠ¡IDéƒ½ä¼šå˜åŒ–
3. æ•°æ®ä¸æŒä¹…åŒ–ï¼Œé‡å¯åä¸¢å¤±
4. ä¸»è¦ç”¨äºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ

## æ•…éšœæ’é™¤

### ç«¯å£è¢«å ç”¨
å¦‚æœ6677ç«¯å£è¢«å ç”¨ï¼Œå¯ä»¥ä¿®æ”¹ `main.py` æ–‡ä»¶ä¸­çš„ç«¯å£å·ï¼š
```python
uvicorn.run(app, host="0.0.0.0", port=6678)  # æ”¹ä¸º6678æˆ–å…¶ä»–ç«¯å£
```

### ä¾èµ–å®‰è£…å¤±è´¥
ç¡®ä¿Pythonç‰ˆæœ¬ >= 3.8ï¼š
```bash
python3 --version
```

### è™šæ‹Ÿç¯å¢ƒé—®é¢˜
åˆ é™¤å¹¶é‡æ–°åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼š
```bash
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```
